# 10.5---HAProxy-Nginx
Load Balansing with HAProxy and Nginx

## Задание 1
Что такое балансировка нагрузки и зачем она нужна?

Балансировка нагрузки это  инструмент распределения трафика по пулу серверов. Балансировку можно осуществить на L4 и L7 уровнях, на software/hardware решениях. Преимущества:
- Самое важное это отказоустойчивость кластера. Балансировщик распределяет нагрузку по кластеру, а в случаях сбоя какого-либо узла приложение будет доступным, т.к. трафик будет распределен на "живые" узлы.
- Производительность. Распределяя нагрузку на несколько узлов можно переварить большой объем трафика.
- Масштабирование. В случае роста проекта и как следствие нагрузки можно без проблем нарастить ресурс кластера, включив новые узлы в балансировку.

## Задание 2
Чем отличаются алгоритмы балансировки Round Robin и Weighted Round Robin? В каких случаях каждый из них лучше применять?

Round Robin - алгоритм кругового распределния нагрузки по пулу серверов. RR распределяет нагрузку равномерно, грубо говоря это цикличный перебор серверов. На практике часто этот метод используется при работе с DNS-серверами. 

Однако у такого решения есть и недостаток, RR не учитывает мощность/загруженность отдельных узлов. Чтобы решить эту проблему используют Weighted Round Robin. При использовании WRR каждому узлу в кластере присвается вес в соответствии с мощностю ноды. Соответствнно если в кластере узлы разнородные по железу(как часто хэто и бывает), то можно дать больший вес самому мощному серверу, а серверам по-слабее дать вес меньший.  

## Задание 4-5
4. Установите и запустите Nginx.
Приведите скриншот systemctl status nginx, где будет видно, что Nginx запущен.
5. Настройте Nginx на виртуальной машине таким образом, чтобы при запросе:
curl http://localhost:8088/ping
он возвращал в ответе строчку:
"nginx is configured correctly".
Приведите конфигурации настроенного Nginx сервиса и скриншот результата выполнения команды curl http://localhost:8088/ping.

```
server {
listen 8088;

location /{
return 200 'nginx is configured correctly';
 }
}
```

![nginx_result](https://github.com/RSafin12/10.5-HAProxy-Nginx/blob/main/nginx_result.png)

## Задание 3-6
3. Установите и запустите Haproxy.
Приведите скриншот systemctl status haproxy, где будет видно, что Haproxy запущен.
![haproxy-installed](https://github.com/RSafin12/10.5-HAProxy-Nginx/blob/main/haproxy-installed.png)

6. Настройте Haproxy таким образом, чтобы при ответе на запрос:
curl http://localhost:8080/
он проксировал его в Nginx на порту 8088, который был настроен в задании 5 и возвращал от него ответ:
"nginx is configured correctly".
Приведите конфигурации настроенного Haproxy и скриншоты результата выполнения команды curl http://localhost:8080/.

Я настроил 2 VDS, повесив на nginx разные сообщения.
Результат выполнения, как видно при curl-запросе поочередно перкидвает на разные серверы.
![haproxy_balansing](https://github.com/RSafin12/10.5-HAProxy-Nginx/blob/main/haproxy_balansing.png)

Для настройки балансировки в дефолтный файл /etc/haproxy/haproxy.cfg добавил секции frontend и backend. Весь конфиг не привожу, он доступен [тут](https://github.com/RSafin12/10.5-HAProxy-Nginx/blob/main/haproxy.cfg).
```
### Fronted section
frontend task-6_front
bind *:8080
# status uri /haproxy?stats
default_backend task-6_back

### Backend section
backend task-6_back
balance roundrobin
# mode http
server brave 172.16.16.16:8088 check
server strong 172.16.16.15:8088 check
```
